Script summary
================================================================================
A transcriptome assembly and paired-end genome skim raw data are combined to 
get hundreds of orthologous LCN loci. Enrichment of multi-copy loci is 
minimized by using unique transcripts only, which are obtained by comparing all 
transcripts and removing those sharing ≥90% sequence similarity using BLAT. 
Before matching the genome skim data against those unique transcripts, reads of 
plastid and mitochondrial origin are removed with Bowtie 2 utilizing reference 
sequences. Paired-end reads are subsequently combined with FLASH. These 
processed reads are matched against the unique transcripts sharing ≥85% 
sequence similarity with BLAT. Transcripts with >1000 BLAT hits, indicating 
repetitive elements, and BLAT hits containing masked nucleotides are removed 
before de novo assembly of the BLAT hits to larger contigs with Geneious, using 
the medium sensitivity / fast setting. After assembly, only those contigs that 
comprise exons of a minimum bait length (usually ≥120 bp in case of probe 
design for phylogenies) and have a certain minimum total locus length (multiple 
of the bait length, should not be too short in order to obtain sufficient 
phylogenetically informative signal; we recommend at least ≥600 bp) are 
retained. To ensure that probes do not target multiple similar loci, any probe 
sequences sharing ≥90% sequence similarity are removed using cd-hit-est, 
followed by a second filtering step for contigs containing exons of a minimum 
bait length and totaling minimum loci length (see comments above). To ensure 
that plastid sequences are absent from the probes, the probe sequences are 
matched against the plastome reference sharing ≥90% sequence similarity with 
BLAT and the hits removed from the probe set.


Software dependencies and installation
================================================================================



Check file INSTALL for further details.


Basic usage
================================================================================
The script is split into two parts. The workflow is as follows:
1) sondova_part_a.sh: Processes FASTQ genome skim reads together with the FASTA 
   transcriptome data. Removes plastid and mitochondrial reads based on FASTA 
   reference sequences.
2) Geneious: De novo assembles the genome skim reads. Note. You need a copy of 
   Geneious for this step. Visit http://www.geneious.com/ for details.
3) sondova_part_b.sh: Uses the output of Geneious to produce the final probes.

Command-line parameters to run Sondovač
--------------------------------------------------------------------------------
The transcriptome draft assembly of the cosmopolitan weed Oxalis corniculata L. from the 1KP initiative (accession JHCN) and genome skim raw data of an accession of southern African O. obtusa (accession J12) were combined to get hundreds of orthologous LCN loci. Enrichment of multi-copy loci was minimized by using unique transcripts only, which were obtained by comparing all transcripts and removing those sharing ≥90% sequence similarity using BLAT v.32x1 (Kent, 2002). Before matching the O. obtusa genome skim data against those unique transcripts, reads of plastid and mitochondrial origin were removed with Bowtie 2 (Langmead and Salzberg, 2012) utilizing Ricinus communis L. GenBank accessions NC_016736 and NC_015141 as references. Paired-end reads were subsequently combined with FLASH (Magoč and Salzberg, 2011). These processed reads were matched against the unique O. corniculata transcripts sharing ≥85% sequence similarity with BLAT. Transcripts with >1000 BLAT hits, indicating repetitive elements, and O. obtusa BLAT hits containing masked nucleotides were removed before de novo assembly of the O. obtusa BLAT hits to larger contigs with Geneious v.6.1.7 (Kearse et al., 2012), using the medium sensitivity / fast setting. After assembly, only those contigs that comprised exons ≥120 bp and had a total locus length ≥600 bp were retained. To ensure that probes did not target multiple similar loci, any probe sequences sharing ≥90% sequence similarity were removed using cd-hit-est v.4.5.4 (Li and Godzik, 2006), followed by a second filtering step for contigs containing exons ≥120 bp and totaling loci length ≥600 bp. To ensure that plastid sequences were absent from the probes, the probe sequences were matched against the Ricinus plastome reference sharing ≥90% sequence similarity with BLAT and the hits removed from the probe set. Ambiguous sites in the probe sequences, which were generated during assembly of the genome skim reads, were randomly replaced by one of the relevant nucleotides and stretches of up to 5N replaced by T. Tiling density 2☓ was used. The probe design pipeline is summarized in Table S2 (Supporting information).




Optional arguments (if not provided, default values are used):
1) Read length of paired-end reads (parameter -M of FLASH, see its manual for details)"
      echo -e "\t\tDefault value: 250 (allowed values are 125, 150, 250 or 300)"
      echo -e "\t-y\tBLAT score for identity between unique transcript and genome skimming data (parameter -minIdentity, check the BLAT manual for details)"
      echo -e "\t\tDefault value: 85 (range from 1 to 100; if lower target enrichment might be much less efficient)"
      echo -e "\t-s\tBLAT score (range from 100 to 100000; transcripts with higher score will be removed - very likely that these are repetitive elements)"
      echo -e "\t\tDefault value: 1000"
      echo -e "\t${BOLD}WARNING!${NORM} If parameters ${BOLD}-a, -y${NORM} or ${BOLD}-s${NORM} are not provided, default values are taken and it is not possible to change them later (not even in interactive mode)."
      echoXXX

Geneious details
--------------------------------------------------------------------------------
XXX


License
================================================================================
The script is licensed under permissive open-source license allowing 
redistribution and modifications. Check file LICENSE for details and feel free 
to enhance the script.


Other questions not covered here
================================================================================
Please, see https://github.com/V-Z/sondovac/ and feel free to ask any 
question and/or express any wish. The authors will do their best to help you.
