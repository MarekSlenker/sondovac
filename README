Script summary
================================================================================
A transcriptome assembly and paired-end genome skim raw data are combined to 
get hundreds of orthologous LCN loci. Enrichment of multi-copy loci is 
minimized by using unique transcripts only, which are obtained by comparing all 
transcripts and removing those sharing ≥90% sequence similarity using BLAT. 
Before matching the genome skim data against those unique transcripts, reads of 
plastid and mitochondrial origin are removed with Bowtie 2 utilizing reference 
sequences. Paired-end reads are subsequently combined with FLASH. These 
processed reads are matched against the unique transcripts sharing ≥85% 
sequence similarity with BLAT. Transcripts with >1000 BLAT hits, indicating 
repetitive elements, and BLAT hits containing masked nucleotides are removed 
before de novo assembly of the BLAT hits to larger contigs with Geneious, using 
the medium sensitivity / fast setting. After assembly, only those contigs that 
comprise exons of a minimum bait length (usually ≥120 bp in case of probe 
design for phylogenies) and have a certain minimum total locus length (multiple 
of the bait length, should not be too short in order to obtain sufficient 
phylogenetically informative signal; we recommend at least ≥600 bp) are 
retained. To ensure that probes do not target multiple similar loci, any probe 
sequences sharing ≥90% sequence similarity are removed using cd-hit-est, 
followed by a second filtering step for contigs containing exons of a minimum 
bait length and totaling minimum loci length (see comments above). To ensure 
that plastid sequences are absent from the probes, the probe sequences are 
matched against the plastome reference sharing ≥90% sequence similarity with 
BLAT and the hits removed from the probe set.


Software dependencies and installation
================================================================================
Requirements to run Sondovač
--------------------------------------------------------------------------------
Sondovač is using several scientific software packages (namely bam2fastq, BLAT, 
Bowtie2, CD-HIT, FASTX toolkit, FLASH, htsjdk, libgtextutils, Picard and 
SAMtools), and basic UNIX tools. Sondovač will check if those programs are 
installed - available in the PATH (i.e. if the shell application can locate and 
launch respective binaries). If you have those packages installed (in current 
versions), ensure that their binaries are in PATH. This should not be a problem 
for basic tools available in any UNIX-based operating system, as basic 
installation usually contains all needed tools. If you are lacking some of the 
required tools, the script will notify you, and you will have to install them 
manually. If this will be needed, check the documentation for your operating 
system.
If required scientific programs are not installed, Sondovač will offer you 
installation. You can use precompiled binaries available together with the 
script or (sometimes) from the web. This is the recommended way. In case you 
would like to compile required software yourselve, the script will guide you 
through this process. Anyway, it is recommended only for advanced users, as 
compilation might sometimes be very tricky. It is currently fully implemented 
only for the Linux distributions Ubuntu and openSUSE. Support for other Linux 
distributions and Mac OS X will be added soon. For compilation you need Apache 
Ant, GNU G++, GNU GCC, GIT, Java, libpng developmental files and zlib 
developmental files. Ensure you have those tools available - they should be 
readily available for any UNIX-based operating system.

Geneious

Check file INSTALL for further details.
--------------------------------------------------------------------------------

Basic usage
================================================================================
The script is split into two parts. The workflow is as follows:
1) sondova_part_a.sh: Processes FASTQ genome skim reads together with the FASTA 
   transcriptome data. Removes plastid and mitochondrial reads based on FASTA 
   reference sequences.
2) Geneious: De novo assembles the genome skim reads. Note. You need a copy of 
   Geneious for this step. Visit http://www.geneious.com/ for details.
3) sondova_part_b.sh: Uses the output of Geneious to produce the final probes.

Command-line parameters to run Sondovač
--------------------------------------------------------------------------------
Optional arguments (if not provided, default values are used), listed in the order of usage in the script:
1) Removal of transcripts sharing a certain sequence similarity with BLAT:
   parameter -minIdentity
   default value: 90
   allowed values: range from 1 to 100 (please consider the trade-off between orthology and number of remaining transcripts for probe design)
2) Combination of paired-end genome skim reads with FLASH:
   parameter -M
   default value: 250
   allowed values: 125, 150, 250, 300 (length of the paired-end reads)
3) Matching of the unique transcripts and the filtered, combined genome skim reads sharing a certain sequence similarity with BLAT:
   parameter -minIdentity
   default value: 85
   allowed values: range from 1 to 100 (please consider the trade-off between probe specificity and number of remaining matching sequences for probe design)
4) Filtering of BLAT output with UNIX commands - choice of transcript or genome skim sequences for further processing:
   parameter XXX
   default value: XXX
   allowed values: XXX (choice depends on whether you want to the probe sequences more similar to the transcripts or genome skim data; this depends on the extent of your phylogenetic study as well as the putative position of the taxa, from which the transcripts and genome skim data were obtained, herein)
5) Filtering of BLAT output with UNIX commands - removal of transcripts with a high number of BLAT hits (indicating repetitive elements):
   parameter XXX
   default value: 1000
   allowed values: range from 100 to 10000
6a) Retention of those contigs that comprise exons ≥ bait length with UNIX commands:
   parameter XXX
   default value: 120
   allowed values: 80, 100, 120 (bait length)
6b) Retention of those contigs that have a certain total locus length with UNIX commands:
   parameter XXX
   default value: 600
   allowed values: 600, 720, 840, 960, 1080, 1200 (please consider the trade-off between sequences with repetitve elements and number of remaining sequences for probe design)
7) Removal of probe sequences sharing a certain sequence similarity with cd-hit-est:
   parameter XXX
   default value: 90
   allowed values: range from 1 to 100
   100-10000 
8a) Retention of those contigs that comprise exons ≥ bait length with UNIX commands:
   parameter XXX
   default value: 120
   allowed values: 80, 100, 120 (bait length)
8b) Retention of those contigs that have a certain total locus length with UNIX commands:
   parameter XXX
   default value: 600
   allowed values: 600, 720, 840, 960, 1080, 1200 (please consider the trade-off between sequences with repetitve elements and number of remaining sequences for probe design)

Geneious details
--------------------------------------------------------------------------------
medium sensitivity / fast setting


License
================================================================================
The script is licensed under permissive open-source license allowing 
redistribution and modifications. Check file LICENSE for details and feel free 
to enhance the script.


Other questions not covered here
================================================================================
Please, see https://github.com/V-Z/sondovac/ and feel free to ask any 
question and/or express any wish. The authors will do their best to help you.
